# Problem 1. Create a vector object containing the names of the days of the week.
days_week <- c("Monday", "Tuesday", "Wednesday","Thursday", "Friday")
days_week
# create a vector of character strings
animal <- c("frog", "spider", "worm", "bee")
animal
days_year
days_year <- 1:365
days_year
days_week [3]
r <- 0:100
area <- pi*(r^2)
area [3]
area [4]
area [3]
dogs <- c(2, 0, 1, 0, 1)
cats <- c(1, 0, 0, 2, 3)
total_pets <- dogs + cats
total_pets
dogs <- c(2, 0, 1, 0, 1)
cats <- c(1, 0, 0, 2, 3)
total_pets_per_household <- dogs + cats
total_pets_per_household
library(openxlsx)
data_frame <- read.xlsx(xlsxFile = "project_data_set.xlsx", sheet = 'sheet1')
library(openxlsx)
data_frame <- read.xlsx(xlsxFile = "project_data_set.xlsx", sheet = 'sheet1')
library(openxlsx)
data_frame <- read.xlsx(xlsxFile = "project_data_set.xlsx", sheet = 'Sheet1')
library(openxlsx)
data_frame <- read.xlsx(xlsxFile = "project_data_set.xlsx")
data_frame <- read.xlsx(file.choose())
my_data <- read.delim("GSE203554_borchelt.final")
my_data <- read.delim("GSE203554_borchelt.final.txt")
my_data <- read.delim(file.choose())
data <- read.table("GSE203554_borchelt.final.txt", header = TRUE, sep = "\t")
data <- read.table("/Users/schiebpe/Library/CloudStorage/OneDrive-Vanderbilt/# Data Analysis/GSE203554_borchelt.final.txt", header = TRUE, sep = "\t")
data(/Users/schiebpe/Library/CloudStorage/OneDrive-Vanderbilt/# Data Analysis/GSE203554_borchelt.final.txt)
#####################
##### Load data #####
#####################
#getwd()
#where r project was created
#setwd()
#set a new path for data have to redo everytime
data(mtcars)
#####################
##### Load data #####
#####################
#getwd()
#where r project was created
#setwd()
#set a new path for data have to redo everytime
data(mtcars)
my_data <- read.delim(file.choose())
data <- read.table("/Users/schiebpe/Library/CloudStorage/OneDrive-Vanderbilt/# Data Analysis/GSE203554_borchelt.final.txt", header = TRUE, sep = "\t")
getwd("GSE203554_borchelt.final.txt")
getwd()
#####################
##### Load data #####
#####################
getwd()
setwd("/Users/schiebpe/Library/CloudStorage/OneDrive-Vanderbilt/# Data Analysis/GSE203554_borchelt.final.txt")
data("GSE203554_borchelt.final.txt")
file.show("/Users/schiebpe/Library/CloudStorage/OneDrive-Vanderbilt/# Data Analysis/GSE203554_borchelt.final.txt")
source("scripts/0_vectors.R")
view(data)
View(data)
setwd("~/OneDrive - Vanderbilt/# Data Analysis/project_data_analysis")
install.packages("pacman")
library(pacman)
pacman::p_load(tidyverse,
devtools,
janitor,
dplyr,
stats,
patchwork,
stringr,
stats,
patchwork,
ggplot2,
tidymodels,
ggcorrplot
)
install.packages("ggcorrplot")
library(ggcorrplot)
# Read data file
diabetes <- read.csv("diabetes.csv")
# Set column names
colnames(diabetes) <- c("Pregnancies", "Glucose", "Blood Pressure", "Skin Thickness", "Insulin", "Body Mass Index",
"Diabetes Pedigree Function", "Age", "Outcome")
# Set consistent row and columnm names
rownames(correlation_matrix) <- colnames(correlation_matrix)
install.packages("ggcorrplot")
#install.packages("pacman")
library(pacman)
pacman::p_load(tidyverse,
devtools,
janitor,
dplyr,
stats,
patchwork,
stringr,
stats,
patchwork,
ggplot2,
tidymodels,
ggcorrplot
)
#install.packages("ggcorrplot")
library(ggcorrplot)
# Read data file
diabetes <- read.csv("diabetes.csv")
# Set column names
colnames(diabetes) <- c("Pregnancies", "Glucose", "Blood Pressure", "Skin Thickness", "Insulin", "Body Mass Index",
"Diabetes Pedigree Function", "Age", "Outcome")
# Set consistent row and columnm names
rownames(correlation_matrix) <- colnames(correlation_matrix)
#install.packages("pacman")
library(pacman)
pacman::p_load(tidyverse,
devtools,
janitor,
dplyr,
stats,
patchwork,
stringr,
stats,
patchwork,
ggplot2,
tidymodels,
ggcorrplot
)
#install.packages("ggcorrplot")
library(ggcorrplot)
# Read data file
diabetes <- read.csv("diabetes.csv")
View(diabetes)
# Set column names
colnames(diabetes) <- c("Pregnancies", "Glucose", "Blood Pressure", "Skin Thickness", "Insulin", "Body Mass Index",
"Diabetes Pedigree Function", "Age", "Outcome")
View(diabetes)
# Set consistent row and columnm names
rownames(correlation_matrix) <- colnames(correlation_matrix)
# Calculate the correlation matrix (excluding the Outcome column if it's binary)
correlation_matrix <- round(cor(diabetes), 1)
# Set consistent row and columnm names
rownames(correlation_matrix) <- colnames(correlation_matrix)
# Create the correlation plot using ggcorrplot
ggcorrplot(
correlation_matrix,
hc.order = TRUE, # Sort correlation matrix hierarchically
type = "full",
lab = TRUE, # Add correlation coefficient labs to plot
lab_size = 3, # Size of correlation coefficient
colors = viridis::viridis(3) # Viridis is a color blind friendly color palette
) +
ggtitle("Correlation Matrix of Health Factors") +
theme_minimal() +
theme(
axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1),  # Rotate x-axis labels to vertical
plot.title = element_text(hjust = 0.5), # Center the plot title
axis.title.x = element_blank(),  # Remove x-axis title
axis.title.y = element_blank()   # Remove y-axis title
) +
guides(
fill = guide_colorbar(title = NULL)  # Remove the color legend title
)
# Binary logistic regression
set.seed(123)
model <- glm(Outcome ~ Glucose, data = diabetes, family = binomial)
summary(model)
# Create a new data frame for predictions
diabetes$predicted_prob <- predict(model, type = "response")
ggplot(diabetes, aes(x = Glucose, y = Outcome)) +
geom_point(alpha = 0.5) +  # Scatter plot of actual data
geom_smooth(method = "glm", method.args = list(family = "binomial"), se = TRUE) +
labs(title = "Glucose Levels and Outcome",
x = "Glucose",
y = "Outcome") +
theme_minimal()
# Model summary and fit statistics
summary(model)
# McFadden's R^2
1 - model$deviance / model$null.deviance
coef(exp(model))
# convert logistic regression output to OR
exp(coef(model))
# Binary logistic regression (DPF)
set.seed(123)
model <- glm(Outcome ~ Diabetes Pedigree Function, data = diabetes, family = binomial)
# Set column names
#colnames(diabetes) <- c("Pregnancies", "Glucose", "Blood Pressure", "Skin Thickness", "Insulin", "Body Mass Index",
"Diabetes Pedigree Function", "Age", "Outcome")
# Set column names
colnames(diabetes) <- c("Pregnancies", "Glucose", "Blood Pressure", "Skin Thickness", "Insulin", "Body Mass Index",
"Diabetes Pedigree Function", "Age", "Outcome")
# Create a new data frame for predictions
diabetes$predicted_prob_glucose <- predict(model, type = "response")
ggplot(diabetes, aes(x = Glucose, y = Outcome)) +
geom_point(alpha = 0.5) +  # Scatter plot of actual data
geom_smooth(method = "glm", method.args = list(family = "binomial"), se = TRUE) +
labs(title = "Glucose Levels and Outcome",
x = "Glucose Level",
y = "Outcome") +
theme_minimal() +
theme(
plot.title = element_text(hjust = 0.5), # Center the plot title
)
ggplot(diabetes, aes(x = Glucose, y = Outcome)) +
geom_point(alpha = 0.5) +  # Scatter plot of actual data
geom_smooth(method = "glm", method.args = list(family = "binomial"), se = TRUE) +
labs(title = "Glucose Levels and Outcome",
x = "Glucose Level (mg/dL)",
y = "Outcome") +
theme_minimal() +
theme(
plot.title = element_text(hjust = 0.5), # Center the plot title
)
ggplot(diabetes, aes(x = Glucose, y = Outcome)) +
geom_point(alpha = 0.5) +  # Scatter plot of actual data
geom_smooth(method = "glm", method.args = list(family = "binomial"), se = TRUE) +
labs(title = "Glucose Levels and Outcome",
x = "Glucose Level (mg/dL)",
y = "P(diabetes)") +
theme_minimal() +
theme(
plot.title = element_text(hjust = 0.5), # Center the plot title
)
# Read data file
diabetes <- read.csv("diabetes.csv")
# Set column names
colnames(diabetes) <- c("Pregnancies", "Glucose", "Blood Pressure", "Skin Thickness", "Insulin", "Body Mass Index",
"Diabetes Pedigree Function", "Age", "Outcome")
# Calculate the correlation matrix (excluding the Outcome column if it's binary)
correlation_matrix <- round(cor(diabetes), 1)
# Set consistent row and columnm names
rownames(correlation_matrix) <- colnames(correlation_matrix)
# Create the correlation plot using ggcorrplot
ggcorrplot(
correlation_matrix,
hc.order = TRUE, # Sort correlation matrix hierarchically
type = "full",
lab = TRUE, # Add correlation coefficient labs to plot
lab_size = 3, # Size of correlation coefficient
colors = viridis::viridis(3) # Viridis is a color blind friendly color palette
) +
ggtitle("Correlation Matrix of Health Factors") +
theme_minimal() +
theme(
axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1),  # Rotate x-axis labels to vertical
plot.title = element_text(hjust = 0.5), # Center the plot title
axis.title.x = element_blank(),  # Remove x-axis title
axis.title.y = element_blank()   # Remove y-axis title
) +
guides(
fill = guide_colorbar(title = NULL)  # Remove the color legend title
)
# Read data file
diabetes <- read.csv("diabetes.csv")
diabetes_copy = diabetes
# Set column names
colnames(diabetes_copy) <- c("Pregnancies", "Glucose", "Blood Pressure", "Skin Thickness", "Insulin", "Body Mass Index",
"Diabetes Pedigree Function", "Age", "Outcome")
# Calculate the correlation matrix (excluding the Outcome column if it's binary)
correlation_matrix <- round(cor(diabetes_copy), 1)
View(diabetes_copy)
#install.packages("pacman")
library(pacman)
pacman::p_load(tidyverse,
devtools,
janitor,
dplyr,
stats,
patchwork,
stringr,
stats,
patchwork,
ggplot2,
tidymodels,
ggcorrplot
)
#install.packages("ggcorrplot")
library(ggcorrplot)
# Read data file
diabetes <- read.csv("diabetes.csv")
# Make a copy of the diabetes dataset so the columns can be renamed
diabetes_copy = diabetes
# Set column names
colnames(diabetes_copy) <- c("Pregnancies", "Glucose", "Blood Pressure", "Skin Thickness", "Insulin", "Body Mass Index",
"Diabetes Pedigree Function", "Age", "Outcome")
View(diabetes)
# Binary logistic regression (DPF)
set.seed(123)
model <- glm(Outcome ~ DiabetesPedigreeFunction, data = diabetes, family = binomial)
summary(model)
# Create a new data frame for predictions
diabetes$predicted_prob_DPF <- predict(model, type = "response")
ggplot(diabetes, aes(x = DiabetesPedigreeFunction, y = Outcome)) +
geom_point(alpha = 0.5) +  # Scatter plot of actual data
geom_smooth(method = "glm", method.args = list(family = "binomial"), se = TRUE) +
labs(title = "Diabetes Pedigree Function and Outcome",
x = "Diabetes Pedigree Function",
y = "P(diabetes)") +
theme_minimal() +
theme(
plot.title = element_text(hjust = 0.5), # Center the plot title
)
# Model summary and fit statistics
summary(model)
# Convert logistic regression output to odds ratio
exp(coef(model))
